<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="Playing with the Diva (android) - Part 2" /><meta property="og:locale" content="en" /><meta name="description" content="Welcome to part 2 of my Diva-android posts. Lets jump right into it 😉️" /><meta property="og:description" content="Welcome to part 2 of my Diva-android posts. Lets jump right into it 😉️" /><link rel="canonical" href="https://roastedchickenz.github.io/posts/Diva-android-part-2/" /><meta property="og:url" content="https://roastedchickenz.github.io/posts/Diva-android-part-2/" /><meta property="og:site_name" content="This is a blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-07T16:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Playing with the Diva (android) - Part 2" /><meta name="twitter:site" content="@" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-07T16:00:00+00:00","datePublished":"2023-01-07T16:00:00+00:00","description":"Welcome to part 2 of my Diva-android posts. Lets jump right into it 😉️","headline":"Playing with the Diva (android) - Part 2","mainEntityOfPage":{"@type":"WebPage","@id":"https://roastedchickenz.github.io/posts/Diva-android-part-2/"},"url":"https://roastedchickenz.github.io/posts/Diva-android-part-2/"}</script><title>Playing with the Diva (android) - Part 2 | This is a blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="This is a blog"><meta name="application-name" content="This is a blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://images.unsplash.com/photo-1615751072497-5f5169febe17?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MXx8Y3V0ZSUyMGRvZ3xlbnwwfHwwfHw%3D&w=1000&q=80" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">This is a blog</a></div><div class="site-subtitle font-italic">Just a blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/roastedchickenz" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Playing with the Diva (android) - Part 2</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Playing with the Diva (android) - Part 2</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1673107200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 7, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/">Tim</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1687 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><p>Welcome to part 2 of my Diva-android posts.<br /> Lets jump right into it 😉️</p><h2 id="5-insecure-data-storage---part-3"><span class="mr-2">5. Insecure Data Storage - Part 3</span><a href="#5-insecure-data-storage---part-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="/public/diva-android-part2/insecure-datastorage3.png" alt="Insecure Data Storage - Part 3" data-proofer-ignore></p><p>I entered “thisisauser” and “notauser” as test data.<br /> Once again, open <code>/sources/jakhar/aseem/diva/InsecureDataStorage3Activity.java</code> to see the source code we decompiled.</p><p>Scanning through the source code, we see that the developer uses temp file this time.<br /> The name of the temp file is prefixed with “uinfo” and suffixed with “tmp” as shown by the line:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nc">File</span> <span class="n">uinfo</span> <span class="o">=</span> <span class="nc">File</span><span class="o">.</span><span class="na">createTempFile</span><span class="o">(</span><span class="s">"uinfo"</span><span class="o">,</span> <span class="s">"tmp"</span><span class="o">,</span> <span class="n">ddir</span><span class="o">);</span>
</pre></table></code></div></div><p>The file is also located on “ddir”, which if we see the source code defined as:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nc">File</span> <span class="n">ddir</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">getApplicationInfo</span><span class="o">().</span><span class="na">dataDir</span><span class="o">);</span>
</pre></table></code></div></div><p>It’s defined as the directory of the app’s package. So this should be pretty simple to find.<br /> All we need to do is go to the package’s directory.<br /> So I ran this on my host machine:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>adb shell
<span class="nb">cd</span> /data/data/jakhar.aseem.diva/
<span class="nb">ls</span> <span class="nt">-la</span> uinfo<span class="k">*</span>
<span class="nb">cat </span>uinfo&lt;randomnuber&gt;tmp
</pre></table></code></div></div><p><img data-src="/public/diva-android-part2/insecure-datastorage3-done.png" alt="Insecure Data Storage - Part 3 done" data-proofer-ignore></p><p>Indeed it shows us the credentials I entered thisisauser:notauser</p><h2 id="6-insecure-data-storage---part-4"><span class="mr-2">6. Insecure Data Storage - Part 4</span><a href="#6-insecure-data-storage---part-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This one require an SD card on your android-x86.<br /> Unfortunately I haven’t figured out how to emulate an SD card and connect it to android-x86.<br /> I tried several things like</p><ol><li><a href="https://stackoverflow.com/questions/61453355/qemu-to-emulate-sd-bus-and-card">adding SD card controller</a><li><a href="https://www.android-x86.org/documentation/sd_card.html">messing around woth /etc/vold.conf</a><li>manually mounting the SD card to /mnt/sdcard</ol><p>Maybe I did something wrong along those steps, if you know how to emulate an SD card with/without virt-manager please let me know.</p><p>Anyway, we can read through the source code</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">jakhar.aseem.diva</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.os.Bundle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.Environment</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.support.v7.app.AppCompatActivity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.util.Log</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.view.View</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.widget.EditText</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.widget.Toast</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileWriter</span><span class="o">;</span>
<span class="cm">/* loaded from: classes.dex */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">InsecureDataStorage4Activity</span> <span class="kd">extends</span> <span class="nc">AppCompatActivity</span> <span class="o">{</span>
    <span class="cm">/* JADX INFO: Access modifiers changed from: protected */</span>
    <span class="nd">@Override</span> <span class="c1">// android.support.v7.app.AppCompatActivity, android.support.v4.app.FragmentActivity, android.support.v4.app.BaseFragmentActivityDonut, android.app.Activity</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_insecure_data_storage4</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">saveCredentials</span><span class="o">(</span><span class="nc">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">EditText</span> <span class="n">usr</span> <span class="o">=</span> <span class="o">(</span><span class="nc">EditText</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">ids4Usr</span><span class="o">);</span>
        <span class="nc">EditText</span> <span class="n">pwd</span> <span class="o">=</span> <span class="o">(</span><span class="nc">EditText</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">ids4Pwd</span><span class="o">);</span>
        <span class="nc">File</span> <span class="n">sdir</span> <span class="o">=</span> <span class="nc">Environment</span><span class="o">.</span><span class="na">getExternalStorageDirectory</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">File</span> <span class="n">uinfo</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">sdir</span><span class="o">.</span><span class="na">getAbsolutePath</span><span class="o">()</span> <span class="o">+</span> <span class="s">"/.uinfo.txt"</span><span class="o">);</span>
            <span class="n">uinfo</span><span class="o">.</span><span class="na">setReadable</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
            <span class="n">uinfo</span><span class="o">.</span><span class="na">setWritable</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
            <span class="nc">FileWriter</span> <span class="n">fw</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileWriter</span><span class="o">(</span><span class="n">uinfo</span><span class="o">);</span>
            <span class="n">fw</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">usr</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">()</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">pwd</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">()</span> <span class="o">+</span> <span class="s">"\n"</span><span class="o">);</span>
            <span class="n">fw</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"3rd party credentials saved successfully!"</span><span class="o">,</span> <span class="mi">0</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"File error occurred"</span><span class="o">,</span> <span class="mi">0</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
            <span class="nc">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">"Diva"</span><span class="o">,</span> <span class="s">"File error: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>If I’m reading the source code correctly, the developer decided to use an external storage device to store user’s information and store them with a file called <code>.uinfo.txt</code></p><p>So we could use something like:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>adb shell
<span class="nb">cd</span> /mnt/sdcard <span class="c"># assuming that sdcard is mounted at /mnt</span>
<span class="nb">cat</span> .uinfo.txt
</pre></table></code></div></div><h2 id="7-input-validation-issue---part-1"><span class="mr-2">7. Input Validation Issue - Part 1</span><a href="#7-input-validation-issue---part-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="/public/diva-android-part2/input-validation1.png" alt="Input Validation Issue - Part 1" data-proofer-ignore></p><p>Reading the description, I can feel my SQLi sense is tingling.<br /> But first, lets try the username “admin” as suggested by the Hint.</p><p><img data-src="/public/diva-android-part2/input-validation-admin.png" alt="admin's creds" data-proofer-ignore></p><p>We get admin’s username, password, and credit card back.<br /> Earlier, I mention SQLi, lets try the most basic SQLi tricks known to man!</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="s1">' OR 1=1 --
</span></pre></table></code></div></div><p><img data-src="/public/diva-android-part2/input-validation-sqli.png" alt="sqli attempt" data-proofer-ignore></p><p>And we got them!</p><p>Reviewing the source code confirms this is vulnerable to SQLi</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nc">Cursor</span> <span class="n">cr</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">mDB</span><span class="o">.</span><span class="na">rawQuery</span><span class="o">(</span><span class="s">"SELECT * FROM sqliuser WHERE user = '"</span> <span class="o">+</span> <span class="n">srchtxt</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">()</span> <span class="o">+</span> <span class="s">"'"</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</pre></table></code></div></div><h2 id="8-input-validation-issue---part-2"><span class="mr-2">8. Input Validation Issue - Part 2</span><a href="#8-input-validation-issue---part-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="/public/diva-android-part2/input-validation2.png" alt="Input Validation Issue - Part 2" data-proofer-ignore></p><p>Reading the description, my gut feeling said that it’s probably fetching local files.<br /> So I tried inputting these:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">cat</span> /proc/cpuinfo
<span class="nb">cat</span> /etc/passwd
<span class="nb">cat</span> /etc/shadow
</pre></table></code></div></div><p>and got none.<br /> Okay, maybe another SQLi?<br /> Tried them and no luck.</p><p>After half an hour or so figuring this out, I finally decided to adb into android</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>adb shell
su
<span class="nb">cat</span> /etc/passwd 
<span class="nb">cat</span> /etc/shadow
</pre></table></code></div></div><p>Both passwd and shadow file does not exists :)</p><p>But /proc/cpuinfo exists yet it doesn’t return anything. Maybe it’s permission issue? So I tried fetching a file within the package directory. I tried fetching shared_prefs file from the previous challenge</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>file:///data/data/jakhar.aseem.diva/shared_prefs/jakhar.aseem.diva_preferences.xml
</pre></table></code></div></div><p>and got this <img data-src="/public/diva-android-part2/input-validation2-shared_prefs.png" alt="shared_prefs file" data-proofer-ignore></p><p>Finally 😃️ It WAS fetching local files, should’ve tried harder at that</p><h2 id="9-access-control-issue---part-1"><span class="mr-2">9. Access Control Issue - Part 1</span><a href="#9-access-control-issue---part-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="/public/diva-android-part2/access-control-issue1.png" alt="Access Control Issue - Part 1" data-proofer-ignore></p><p>Okay, so we’re supposed to access the API credentials page without opening the app.<br /> Lets take a look at the source code</p><p><img data-src="/public/diva-android-part2/access-control-issue1-sourcecode.png" alt="source code" data-proofer-ignore></p><p>At first, I didn’t encounter anything interesting, until I learn about <a href="https://developer.android.com/reference/android/content/Intent">Intent</a></p><p>Spesifically, the developer uses <a href="https://developer.android.com/reference/android/content/Intent#setAction(java.lang.String)">setAction</a> method to do an action, which the developer passed “jakhar.aseem.diva.action.VIEW_CREDS” as the action.</p><p>So we may need to execute setAction manually. I achieve this by executing</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>adb shell
su
am start <span class="nt">-a</span> jakhar.aseem.diva.action.VIEW_CREDS
</pre></table></code></div></div><p><img data-src="/public/diva-android-part2/access-control-issue1-done.png" alt="Access Control Issue - Part 1" data-proofer-ignore></p><p>Interestingly, this also works even when diva is not launched</p><h2 id="10-access-control-issue---part-2"><span class="mr-2">10. Access Control Issue - Part 2</span><a href="#10-access-control-issue---part-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="/public/diva-android-part2/access-control-issue2.png" alt="Access Control Issue - Part 2" data-proofer-ignore></p><p>When we choose “Register now”, it’ll tell us to register. And if we choose “Already Registered”, it’ll bring us to the API credentials page. Great, now we just have to access the “Already Registered” page.</p><p>Trying Intent the exact same way as previous challenge will bring us to the “Register Now” page. So we need to bypass it somewhow. Well, lets read the source code!</p><p>It seems like the code that prevents us from sending an arbitrary Intent like before is this line of code</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kt">boolean</span> <span class="n">chk_pin</span> <span class="o">=</span> <span class="n">rbregnow</span><span class="o">.</span><span class="na">isChecked</span><span class="o">();</span>
<span class="n">i</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">getString</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">chk_pin</span><span class="o">),</span> <span class="n">chk_pin</span><span class="o">);</span>
</pre></table></code></div></div><p>We need to somehow bypass this check. Looking through am help page, I encounter this</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>[--ez &lt;EXTRA_KEY&gt; &lt;EXTRA_BOOLEAN_VALUE&gt; ...]
</pre></table></code></div></div><p>Nice!! so we pass an abitrary value to the app. So, I tried this command:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>adb shell
su
am start -a jakhar.aseem.diva.action.VIEW_CREDS2 --ez chk_pin false
</pre></table></code></div></div><p>and…. it doesn’t work. Why? Well, I’m also banging my head to the wall. I also check <code>R.java</code> and of course tried to decode hex to string and get nothing.<br /> But, checking <code>R.java</code> might not be a bad idea after all, the variable from <code>R.java</code> must exist somewhere right?<br /> So I search using <code>grep -R -i chk_pin</code> and lo and behold, I found this</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>resources/res/values/strings.xml:    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"chk_pin"</span><span class="nt">&gt;</span>check_pin<span class="nt">&lt;/string&gt;</span>
</pre></table></code></div></div><p>So we now know why <code> am start -a jakhar.aseem.diva.action.VIEW_CREDS2 --ez chk_pin false </code> doesn’t work, because it’s called check_pin instead of chk_pin by the application.</p><p>With that in mind, all we need to do is exeucte this</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>am start <span class="nt">-a</span> jakhar.aseem.diva.action.VIEW_CREDS2 <span class="nt">--ez</span> check_pin <span class="nb">false</span>
</pre></table></code></div></div><p>and we got it!</p><p><img data-src="/public/diva-android-part2/access-control-issue2-done.png" alt="access control issue part 2 done " data-proofer-ignore></p><h2 id="11-access-control-issue---part-3"><span class="mr-2">11. Access Control Issue - Part 3</span><a href="#11-access-control-issue---part-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="/public/diva-android-part2/access-control-issue3.png" alt="access control issue part " data-proofer-ignore></p><p>This challenges feature a create pin function. Interesting. For testing purposes I entered “1234” After that I can access private notes if I provide the pin “1234”</p><p>Looking at the source code for this, it looks like the developer uses shared_prefs again as shown by this line</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nc">SharedPreferences</span> <span class="n">spref</span> <span class="o">=</span> <span class="nc">PreferenceManager</span><span class="o">.</span><span class="na">getDefaultSharedPreferences</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
<span class="nc">String</span> <span class="n">pin</span> <span class="o">=</span> <span class="n">spref</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">getString</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">string</span><span class="o">.</span><span class="na">pkey</span><span class="o">),</span> <span class="s">""</span><span class="o">);</span>
</pre></table></code></div></div><p>This has been shown to be NOT a secure way to store credentials, so we might need it later.<br /> Looking through the source code more thoroughly, I notice something different with this challenges compared to the last two Access control issue challenges. That is, there are no SetAction to be made, this is huge, since the last two challenges I depend on the action to be made and trigger it manually through the command line. Looks like I need some another way!</p><p>After giving up for possibly a billionth times I finally found a way. I simply need to access the file in the terminal! Instead of setAction, turns out the developer uses hardcoded URI on <code> NotesProvider.java </code> to access the notes shown by this line</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nc">NotesProvider</span><span class="o">.</span><span class="na">java</span><span class="o">:</span>    <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Uri</span> <span class="no">CONTENT_URI</span> <span class="o">=</span> <span class="nc">Uri</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"content://jakhar.aseem.diva.provider.notesprovider/notes"</span><span class="o">);</span>
</pre></table></code></div></div><p>I use <code> adb shell content </code> to access the file. Also, While browsing the internet, it turns out that this is a quite obvious vulnerability shown by this <a href="https://stackoverflow.com/a/27993247">comment</a></p><p>With that in mind, all I need to do is:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>adb shell
su
content query <span class="nt">--uri</span> content://jakhar.aseem.diva.provider.notesprovider/notes/
</pre></table></code></div></div><p><img data-src="/public/diva-android-part2/access-control-issue3-done.png" alt="access control issue part " data-proofer-ignore></p><h2 id="12-hardcoding-issue---part-2"><span class="mr-2">12. Hardcoding Issue - Part 2</span><a href="#12-hardcoding-issue---part-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="/public/diva-android-part2/hardcoding-issue2.png" alt="hardcoding issue part 2" data-proofer-ignore></p><p>This one is quite tough, I tried looking through logcat, decoding <code> R.java </code>, and bruteforce :D. Nothing works.<br /> What eventually works is looking through the source code again and reading them properly.</p><p>The first and most obvious thing to do is go to <code> Hardcode2Activity.java </code>. Here, I find:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kd">private</span> <span class="nc">DivaJni</span> <span class="n">djni</span><span class="o">;</span>
<span class="k">this</span><span class="o">.</span><span class="na">djni</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DivaJni</span><span class="o">();</span>
</pre></table></code></div></div><p>These lines tells us it loads another file called DivaJni. Opening that file, I find:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">soName</span> <span class="o">=</span> <span class="s">"divajni"</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">native</span> <span class="kt">int</span> <span class="nf">access</span><span class="o">(</span><span class="nc">String</span> <span class="n">str</span><span class="o">);</span>
    <span class="kd">static</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">loadLibrary</span><span class="o">(</span><span class="n">soName</span><span class="o">);</span>
    <span class="o">}</span>
</pre></table></code></div></div><p>These lines tells us that the application load a library called “divajni”. A little searching bring me <a href="https://stackoverflow.com/questions/27886092/system-loadlibrary-in-android">here</a>.<br /> Accepted answer tells us the extension is different for different operating system. The extension mentioned is either <code> .a </code> or <code> .so </code><br /> I try to find both with:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>find <span class="nb">.</span> | <span class="nb">grep </span>divajni.a
find <span class="nb">.</span> | <span class="nb">grep </span>divajni.so
</pre></table></code></div></div><p>The first command doesn’t output anything, the second command however, outputs many file called <code> libdivajni.so </code> for different architecture. I chose x86_64 since that’s what I’m using. This is a compiled shared library so I can’t view what’s inside easily. I tried putting <code> libdivajni.so </code> to jadx again and doesn’t seem to work.<br /> Then I tried the <code> strings </code> command and it outputs a lot of different dependencies libraries and the hardcoded password!</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="nv">$ </span>strings libdivajni.so 

__cxa_finalize
__cxa_atexit
Java_jakhar_aseem_diva_DivaJni_access
Java_jakhar_aseem_diva_DivaJni_initiateLaunchSequence
strcpy
JNI_OnLoad
_edata
__bss_start
_end
libstdc++.so
libm.so
libc.so
libdl.so
libdivajni.so
&lt;<span class="nv">$!</span>H
olsdfgad<span class="p">;</span>lh
.dotdot
<span class="p">;</span><span class="k">*</span>3<span class="s2">$"
GCC: (GNU) 4.9 20140827 (prerelease)
gold 1.11
.shstrtab
.dynsym
.dynstr
.hash
.rela.dyn
.rela.plt
.text
.rodata
.eh_frame
.eh_frame_hdr
.fini_array
.init_array
.dynamic
.got
.got.plt
.data
.bss
.comment
.note.gnu.gold-version
</span></pre></table></code></div></div><p>It’s hidden between those library I almost missed them. For the record, I tried <code> &lt;$!H </code> first thinking that is the password.</p><p><img data-src="/public/diva-android-part2/hardcoding-issue2-done.png" alt="hardcoding issue part 2 done" data-proofer-ignore></p><h2 id="13-input-validation-issue---part-3"><span class="mr-2">13. Input Validation Issue - Part 3</span><a href="#13-input-validation-issue---part-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="/public/diva-android-part2/input-validation3.png" alt="Input validation Issue - part 3" data-proofer-ignore></p><p>Well, it asks to crash the app, the first thing that pop to my brain is inputting a big string. So, I input:</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabbbbaaaggaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
</pre></table></code></div></div><p>Definitely didn’t count the string length but it did crash the app! To cross-check, I look through logcat and found this</p><p><img data-src="/public/diva-android-part2/input-validation3-done.png" alt="Input validation Issue - part 3 done" data-proofer-ignore> SIGSEGV - Signal segmentation fault. A classic memory corruption vulnerability</p><h2 id="done"><span class="mr-2">Done</span><a href="#done" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This has been quite fun! Definitely learn some new tricks 😃️</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/portable-computer/'>portable-computer</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/android/" class="post-tag no-text-decoration" >android</a> <a href="/tags/diva-android/" class="post-tag no-text-decoration" >diva-android</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Playing+with+the+Diva+%28android%29+-+Part+2+-+This+is+a+blog&url=https%3A%2F%2Froastedchickenz.github.io%2Fposts%2FDiva-android-part-2%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Playing+with+the+Diva+%28android%29+-+Part+2+-+This+is+a+blog&u=https%3A%2F%2Froastedchickenz.github.io%2Fposts%2FDiva-android-part-2%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Froastedchickenz.github.io%2Fposts%2FDiva-android-part-2%2F&text=Playing+with+the+Diva+%28android%29+-+Part+2+-+This+is+a+blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Diva-android/">Playing with the Diva (android) - Part 1</a><li><a href="/posts/elasticsearch/">Elastic stack - Setting up elasticsearch, kibana, and elasticagent</a><li><a href="/posts/creating-custom-alert/">Elastic stack - Use 3rd party threat intelligence as Reference data</a><li><a href="/posts/things-i've-learned-in-philosophy/">What I think the most important lesson I've learned through philosophy</a><li><a href="/posts/microcorruption-sydney/">Microcorruption - Sydney</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/assembly/">assembly</a> <a class="post-tag" href="/tags/microcorruption/">microcorruption</a> <a class="post-tag" href="/tags/msp430/">msp430</a> <a class="post-tag" href="/tags/diva-android/">diva-android</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a> <a class="post-tag" href="/tags/3rd-party-threat-intel/">3rd party threat intel</a> <a class="post-tag" href="/tags/abuseipdb/">abuseipdb</a> <a class="post-tag" href="/tags/philosophy/">philosophy</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Diva-android/"><div class="card-body"> <em class="small" data-ts="1671850800" data-df="ll" > Dec 24, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Playing with the Diva (android) - Part 1</h3><div class="text-muted small"><p> Today I’m going to share my experience playing diva-android for the first time. Diva-android is an intentionally vulnerable android app in an attempt to educate pentester on the basic of android pe...</p></div></div></a></div><div class="card"> <a href="/posts/uncrackable1/"><div class="card-body"> <em class="small" data-ts="1673928000" data-df="ll" > Jan 17, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Uncrackable1</h3><div class="text-muted small"><p> Today I want to share my experience playing Uncrackable1 by OWASP MASTG with some limitations I intentionally put. This limitation is: solve Uncrackable1 with only a debugger and nothing else! No F...</p></div></div></a></div><div class="card"> <a href="/posts/uncrackable2/"><div class="card-body"> <em class="small" data-ts="1675742400" data-df="ll" > Feb 7, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Uncrackable2</h3><div class="text-muted small"><p> Today I want to share my experience playing Uncrackable2 by OWASP MASTG. Lets start! Tools I use Android Studio electric eel for debugger and android emulation jadx 1.4.5 for decompiling U...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Diva-android/" class="btn btn-outline-primary" prompt="Older"><p>Playing with the Diva (android) - Part 1</p></a> <a href="/posts/uncrackable1/" class="btn btn-outline-primary" prompt="Newer"><p>Uncrackable1</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/assembly/">assembly</a> <a class="post-tag" href="/tags/microcorruption/">microcorruption</a> <a class="post-tag" href="/tags/msp430/">msp430</a> <a class="post-tag" href="/tags/diva-android/">diva-android</a> <a class="post-tag" href="/tags/elasticsearch/">elasticsearch</a> <a class="post-tag" href="/tags/3rd-party-threat-intel/">3rd party threat intel</a> <a class="post-tag" href="/tags/abuseipdb/">abuseipdb</a> <a class="post-tag" href="/tags/philosophy/">philosophy</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/">Tim</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
